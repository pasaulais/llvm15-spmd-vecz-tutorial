%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{SIMD Width Detection}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Instantiation}

\begin{itemize}
    \item Not all instructions can be packetized
    \begin{itemize}
        \item External function with side-effcts (e.g. \texttt{printf})
        \item Atomic builtins
    \end{itemize}
    \item Solution: instantiate the instruction for all lanes ($i \in [0;N)$)
    \begin{itemize}
        \item Duplicate scalar instructions $N$ times
        %\item Replace $tid$ with \texttt{$tid + i$} (e.g. calls to \texttt{get\_global\_id}, \texttt{get\_local\_id})
        \item Replace $tid$ with \texttt{$tid + i$} (e.g. calls to \texttt{get\_global\_id})
        \item Need to extract packetized operands $N$ times %(using \texttt{extractelement})
    \end{itemize}
    \item Happens during the packetization stage
    \item Can be an alternative to scalarization
    \begin{itemize}
        \item Instantiation then becomes a stage of its own
        \item Analysis determines when to instatiate, when to scalarize
    \end{itemize}
\end{itemize}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Vectorizing Builtin Function Calls}

% Builtin: the vectorizer has some knowledge of scalar -> vector function mapping

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Vectorizing Builtin Functions}

% By vectorizing the builtin's body
% This changes the function signature (return value, some arguments)
% Builtin: the vectorizer has some knowledge of which arguments need packetization
% Need argument placeholders (cloning required)
% Packetized arguments are roots (Uniform Value Analysis)
% Return instructions are leaves (Packetization Stage)

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Vectorizing User Functions (No Side-Effects)}

% Similar to builtin functions, but with no knowledge of whether arguments need
% packetization. Need to analyze this for each call site.

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Vectorizing User Functions (Side-Effects)}

% Need to pass a mask as an extra argument
% Might be simpler to just inline such functions

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Interleaved Memory Optimizations}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{SoA to AoS Conversion}

\end{frame}
